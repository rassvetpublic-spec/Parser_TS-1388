# Инструкции для агентов

Эти правила применяются ко всему репозиторию.

- Основной исходник парсера — модуль `VBA/Parser_TS-1388_Module_PARSER.bas`. Все правки делайте в экспортированном `.bas`, а затем при необходимости импортируйте их в `Parser_TS-1388.xlsm` через `Import-VBA.ps1`; не редактируйте код прямо в файле Excel.
- При изменении грамматики или правил разбора обновляйте связанные документы в `spec_docs` (например, `Grammar.md`, `TokenRules.md`) и держите их в актуальном состоянии вместе с кодом.
- Используйте явную обработку ошибок: `On Error GoTo EH` с завершением через `On Error GoTo 0`; не оставляйте `On Error Resume Next` без явного восстановления и логирования.
- Предпочитайте маленькие процедуры с понятными именами и комментариями по ключевым шагам разбора, чтобы упростить ревью и отладку.
- В ответах указывайте любые вручную выполняемые шаги (например, экспорт/импорт макросов), если без них изменения не заработают.
